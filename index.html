<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style/main.css">
    <link rel="stylesheet" href="style/header.css">
    <link rel="stylesheet" href="style/styles.css">
    <title>OPD-Prof-Score - Main</title>
</head>
<body>
    <header class="header">
        <nav class="nav-container">
            <a href="index.html" class="logo"><img src="assets/logo_end.png" width="150"> </a>

            <div class="nav-links">
                <a href="#professions" class="nav-item">Лист профессий</a>

                <div class="auth-buttons unauthorized">
                    <a href="sign-in.html" class="btn login">Вход</a>
                    <a href="sign-up.html" class="btn register">Регистрация</a>
                </div>
                <div class="auth-buttons authorized">
                    <a href="index.html" id="logout-btn" class="btn login">Выход</a>
                    <a href="user-profile.html" class="btn register">Личный кабинет</a>
                </div>
            </div>
        </nav>
    </header>
    <main>
        <section class="professions-section">
            <h2>Популярные профессии</h2>
            <div class="profession-cards-container">

            </div>
        </section>
    </main>
</body>
<script type="module" src="js/header.js"></script>
<script type="module" src="js/auth.js"></script>
<script>
    const cardSection = document.querySelector(".profession-cards-container")
    fetch("http://localhost:8081")
    // Функция для переворота карточки
    function flipCard(card) {
        card.classList.toggle('flipped');
    }

    window.onload = async () => {
        const response = await fetch("http://localhost:8081/get-professions-all")
        const professions = await response.json()
        if (professions) {
            professions.data.forEach(profession => {
                if (!profession.is_archive) {
                    const professionCard = document.createElement("div")
                    const cardInner = document.createElement("div")
                    const cardFront = document.createElement("div")
                    const cardBack = document.createElement("div")
                    const professionDesc = document.createElement("p")
                    const professionName = document.createElement("h3")
                    const professionIcon = document.createElement("div")
                    const professionImg = document.createElement("img")
                    professionImg.src = "./assets/alisa_stock.png"
                    const professionLink = document.createElement("a")

                    professionCard.classList.add("profession-card")
                    cardInner.classList.add("card-inner")
                    cardFront.classList.add("card-front")
                    cardBack.classList.add("card-back")
                    professionName.classList.add("profession-title")
                    professionDesc.classList.add("profession-description")
                    professionIcon.classList.add("profession-icon")
                    professionLink.classList.add("profession-link")

                    professionName.innerHTML = profession.name
                    professionDesc.innerHTML = profession.description
                    professionLink.innerHTML = "Подробнее"
                    professionIcon.append(professionImg)
                    cardFront.append(professionIcon, professionName.cloneNode(true), professionDesc.cloneNode(true), professionLink)
                    professionDesc.innerHTML = `Требования: ${profession.requirements}`
                    cardBack.append(professionName, professionDesc.cloneNode(true))
                    professionDesc.innerHTML = `Сфера деятельности: ${profession.sphere}`
                    cardBack.append(professionDesc)
                    cardInner.append(cardFront, cardBack)
                    professionCard.append(cardInner)
                    professionCard.addEventListener("click",() => {
                        professionCard.classList.toggle("flipped")
                    })
                    professionLink.addEventListener("click", () => {
                        window.location.replace(`profession.html?id=${profession.id}`)
                    })
                    cardSection.append(professionCard)
                }
            })
        }
    }
</script>
</html>